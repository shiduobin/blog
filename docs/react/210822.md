---
title: 使用自定义 Hook 实现函数防抖与函数节流
categories:
  - React
---

# 什么是 Hook

Hook 是 React 16.8 的新增特性。它可以让你在不编写 class 的情况下使用 state 以及其他的 React 特性。想知道如何自定义 Hook 的童鞋，可以查看[官方文档](https://react.docschina.org/docs/hooks-custom.html) 这里不再赘述。

# 什么是节流和防抖

防抖和节流的作用都是防止函数多次调用，关于它们的具体作用和区别可以查看[这篇内容](/notes/deb&thro.html)做了详细解释。

## 函数防抖的 Hook 实现

```js
import { useState, useEffect } from "react";

const useDebounce = (value, delay) => {
  const [debounceValue, setDebounceValue] = useState(value);
  useEffect(() => {
    const timer = setTimeout(() => {
      setDebounceValue(value);
    }, delay);
    return () => clearTimeout(timeout);
  }, [value, delay]);
  return debounceValue;
};
```

## 函数节流的 Hook 实现

```js
import { useState, useEffect, useRef } from "react";

useThrottle(value, delay) {
  const [throttleValue, setThrottleValue] = useState(value);
  let local = useRef({ flag: true }).current;
  useEffect(() => {
    let timer;
    if (local.flag) {
      local.flag = false;
      setThrottleValue(value);
      setTimeout(() => (local.flag = true), delay);
    } else {
      timer = setTimeout(() => setThrottleValue(value), delay);
    }
    return () => clearTimeout(timer);
  }, [value, delay, local]);
  return throttleValue;
}
```
